# RISKS для Workout Log API

Реестр рисков с оценкой вероятности (L), влияния (I) и общего риска (Risk = L × I).
Связь с NFR из `docs/security-nfr/NFR.md` и планом релизов из `NFR_TRACEABILITY.md`.

| RiskID | Описание | Связь (F/NFR) | L | I | Risk | Стратегия | Владелец | Срок | Критерий закрытия |
|--------|----------|---------------|--:|--:|-----:|-----------|----------|------|-------------------|
| R1 | Неавторизованный доступ к данным тренировок | F1, NFR-02 | 3 | 5 | 15 | Снизить | @security-team | 2025-10-20 | 100% эндпоинтов требуют auth |
| R2 | Некорректные данные в БД (отрицательный вес) | F4, NFR-03 | 4 | 3 | 12 | Снизить | @backend-team | 2025-10-15 | Pydantic валидация + тесты |
| R3 | DoS через массовые запросы | F2, NFR-05 | 3 | 4 | 12 | Снизить | @platform-team | 2025-10-18 | Rate limit настроен и протестирован |
| R4 | Переполнение БД большими заметками | F3, NFR-04 | 2 | 3 | 6 | Снизить | @backend-team | 2025-11-01 | Ограничение размера note <= 1000 |
| R5 | Отсутствие аудита ошибок | All, NFR-08 | 2 | 3 | 6 | Снизить | @backend-team | 2025-11-05 | Логирование 5xx настроено |
| R6 | Медленное создание тренировок | F1, NFR-01 | 2 | 4 | 8 | Снизить | @backend-team | 2025-10-25 | p95 <= 250ms в тестах |
| R7 | Уязвимости в зависимостях | All, NFR-07 | 3 | 4 | 12 | Снизить | @security-team | 2025-10-30 | SCA в CI, 0 Critical findings |
| R8 | Утечка данных через логи | F3/4, NFR-08 | 2 | 4 | 8 | Снизить | @backend-team | 2025-11-01 | Security review логов |

## Стратегия снижения рисков

### Срочные меры (v1.0)
1. Включить валидацию Pydantic (R2)
   - Внедрить в `app/models.py`
   - Покрыть тестами в `tests/test_api.py`

2. Настроить rate limiting (R3)
   - Добавить middleware
   - Установить порог 100 req/min

3. Ограничить размер note (R4)
   - Добавить max_length в модель
   - Тесты на 422 при превышении

### Среднесрочные меры (v1.1)
1. Логирование и мониторинг (R5, R8)
   - Настроить структурированное логирование
   - Добавить context manager для ошибок

2. Производительность (R6)
   - Оптимизировать валидацию
   - Подготовить к persistent storage

### Долгосрочные меры (v2.0)
1. Безопасность данных
   - Подготовить к внедрению auth
   - Спроектировать persistent storage

## Метрики и проверки
- Регулярные проверки безопасности
- Performance тесты на CI
- Мониторинг error rate
- Сканирование зависимостей

## Связь с релизами
- v1.0: NFR-02, NFR-03, NFR-05
- v1.1: NFR-04, NFR-08
- v2.0: Остальные улучшения
